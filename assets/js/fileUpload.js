/*!
 * jQuery UI Widget 1.11.0
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/jQuery.widget/
 */
(function(n){typeof define=="function"&&define.amd?define(["jquery"],n):n(jQuery)})(function(n){var i=0,t=Array.prototype.slice;return n.cleanData=function(t){return function(i){for(var r=0,u;(u=i[r])!=null;r++)try{n(u).triggerHandler("remove")}catch(f){}t(i)}}(n.cleanData),n.widget=function(t,i,r){var s,f,u,o,h={},e=t.split(".")[0];return t=t.split(".")[1],s=e+"-"+t,r||(r=i,i=n.Widget),n.expr[":"][s.toLowerCase()]=function(t){return!!n.data(t,s)},n[e]=n[e]||{},f=n[e][t],u=n[e][t]=function(n,t){if(!this._createWidget)return new u(n,t);arguments.length&&this._createWidget(n,t)},n.extend(u,f,{version:r.version,_proto:n.extend({},r),_childConstructors:[]}),o=new i,o.options=n.widget.extend({},o.options),n.each(r,function(t,r){if(!n.isFunction(r)){h[t]=r;return}h[t]=function(){var n=function(){return i.prototype[t].apply(this,arguments)},u=function(n){return i.prototype[t].apply(this,n)};return function(){var i=this._super,f=this._superApply,t;return this._super=n,this._superApply=u,t=r.apply(this,arguments),this._super=i,this._superApply=f,t}}()}),u.prototype=n.widget.extend(o,{widgetEventPrefix:f?o.widgetEventPrefix||t:t},h,{constructor:u,namespace:e,widgetName:t,widgetFullName:s}),f?(n.each(f._childConstructors,function(t,i){var r=i.prototype;n.widget(r.namespace+"."+r.widgetName,u,i._proto)}),delete f._childConstructors):i._childConstructors.push(u),n.widget.bridge(t,u),u},n.widget.extend=function(i){for(var e=t.call(arguments,1),f=0,o=e.length,r,u;f<o;f++)for(r in e[f])u=e[f][r],e[f].hasOwnProperty(r)&&u!==undefined&&(i[r]=n.isPlainObject(u)?n.isPlainObject(i[r])?n.widget.extend({},i[r],u):n.widget.extend({},u):u);return i},n.widget.bridge=function(i,r){var u=r.prototype.widgetFullName||i;n.fn[i]=function(f){var s=typeof f=="string",o=t.call(arguments,1),e=this;return f=!s&&o.length?n.widget.extend.apply(null,[f].concat(o)):f,s?this.each(function(){var t,r=n.data(this,u);return f==="instance"?(e=r,!1):r?!n.isFunction(r[f])||f.charAt(0)==="_"?n.error("no such method '"+f+"' for "+i+" widget instance"):(t=r[f].apply(r,o),t!==r&&t!==undefined?(e=t&&t.jquery?e.pushStack(t.get()):t,!1):void 0):n.error("cannot call methods on "+i+" prior to initialization; attempted to call method '"+f+"'")}):this.each(function(){var t=n.data(this,u);t?(t.option(f||{}),t._init&&t._init()):n.data(this,u,new r(f,this))}),e}},n.Widget=function(){},n.Widget._childConstructors=[],n.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,r){r=n(r||this.defaultElement||this)[0];this.element=n(r);this.uuid=i++;this.eventNamespace="."+this.widgetName+this.uuid;this.options=n.widget.extend({},this.options,this._getCreateOptions(),t);this.bindings=n();this.hoverable=n();this.focusable=n();r!==this&&(n.data(r,this.widgetFullName,this),this._on(!0,this.element,{remove:function(n){n.target===r&&this.destroy()}}),this.document=n(r.style?r.ownerDocument:r.document||r),this.window=n(this.document[0].defaultView||this.document[0].parentWindow));this._create();this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:n.noop,_getCreateEventData:n.noop,_create:n.noop,_init:n.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(n.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:n.noop,widget:function(){return this.element},option:function(t,i){var e=t,r,u,f;if(arguments.length===0)return n.widget.extend({},this.options);if(typeof t=="string")if(e={},r=t.split("."),t=r.shift(),r.length){for(u=e[t]=n.widget.extend({},this.options[t]),f=0;f<r.length-1;f++)u[r[f]]=u[r[f]]||{},u=u[r[f]];if(t=r.pop(),arguments.length===1)return u[t]===undefined?null:u[t];u[t]=i}else{if(arguments.length===1)return this.options[t]===undefined?null:this.options[t];e[t]=i}return this._setOptions(e),this},_setOptions:function(n){for(var t in n)this._setOption(t,n[t]);return this},_setOption:function(n,t){return this.options[n]=t,n==="disabled"&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(t,i,r){var f,u=this;typeof t!="boolean"&&(r=i,i=t,t=!1);r?(i=f=n(i),this.bindings=this.bindings.add(i)):(r=i,i=this.element,f=this.widget());n.each(r,function(r,e){function o(){if(t||u.options.disabled!==!0&&!n(this).hasClass("ui-state-disabled"))return(typeof e=="string"?u[e]:e).apply(u,arguments)}typeof e!="string"&&(o.guid=e.guid=e.guid||o.guid||n.guid++);var s=r.match(/^([\w:-]*)\s*(.*)$/),h=s[1]+u.eventNamespace,c=s[2];c?f.delegate(c,h,o):i.bind(h,o)})},_off:function(n,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;n.unbind(t).undelegate(t)},_delay:function(n,t){function r(){return(typeof n=="string"?i[n]:n).apply(i,arguments)}var i=this;return setTimeout(r,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t);this._on(t,{mouseenter:function(t){n(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){n(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t);this._on(t,{focusin:function(t){n(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){n(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,i,r){var u,f,e=this.options[t];if(r=r||{},i=n.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],f=i.originalEvent,f)for(u in f)u in i||(i[u]=f[u]);return this.element.trigger(i,r),!(n.isFunction(e)&&e.apply(this.element[0],[i].concat(r))===!1||i.isDefaultPrevented())}},n.each({show:"fadeIn",hide:"fadeOut"},function(t,i){n.Widget.prototype["_"+t]=function(r,u,f){typeof u=="string"&&(u={effect:u});var o,e=u?u===!0||typeof u=="number"?i:u.effect||i:t;u=u||{};typeof u=="number"&&(u={duration:u});o=!n.isEmptyObject(u);u.complete=f;u.delay&&r.delay(u.delay);o&&n.effects&&n.effects.effect[e]?r[t](u):e!==t&&r[e]?r[e](u.duration,u.easing,f):r.queue(function(i){n(this)[t]();f&&f.call(r[0]);i()})}}),n.widget});
(function(n){"use strict";typeof define=="function"&&define.amd?define(["jquery"],n):n(window.jQuery)})(function(n){"use strict";var t=0;n.ajaxTransport("iframe",function(i){if(i.async&&(i.type==="POST"||i.type==="GET")){var r,u;return{send:function(f,e){r=n('<form style="display:none;"><\/form>');r.attr("accept-charset",i.formAcceptCharset);u=n('<iframe src="javascript:false;" name="iframe-transport-'+(t+=1)+'"><\/iframe>').bind("load",function(){var t,f=n.isArray(i.paramName)?i.paramName:[i.paramName];u.unbind("load").bind("load",function(){var t;try{if(t=u.contents(),!t.length||!t[0].firstChild)throw new Error;}catch(i){t=undefined}e(200,"success",{iframe:t});n('<iframe src="javascript:false;"><\/iframe>').appendTo(r);r.remove()});r.prop("target",u.prop("name")).prop("action",i.url).prop("method",i.type);i.formData&&n.each(i.formData,function(t,i){n('<input type="hidden"/>').prop("name",i.name).val(i.value).appendTo(r)});i.fileInput&&i.fileInput.length&&i.type==="POST"&&(t=i.fileInput.clone(),i.fileInput.after(function(n){return t[n]}),i.paramName&&i.fileInput.each(function(t){n(this).prop("name",f[t]||i.paramName)}),r.append(i.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data"));r.submit();t&&t.length&&i.fileInput.each(function(i,r){var u=n(t[i]);n(r).prop("name",u.prop("name"));u.replaceWith(r)})});r.append(u).appendTo(document.body)},abort:function(){u&&u.unbind("load").prop("src","javascript".concat(":false;"));r&&r.remove()}}}});n.ajaxSetup({converters:{"iframe text":function(t){return n(t[0].body).text()},"iframe json":function(t){return n.parseJSON(n(t[0].body).text())},"iframe html":function(t){return n(t[0].body).html()},"iframe script":function(t){return n.globalEval(n(t[0].body).text())}}})});
(function(n){"use strict";typeof define=="function"&&define.amd?define(["jquery","jquery.ui.widget"],n):n(window.jQuery)})(function(n){"use strict";n.support.xhrFileUpload=!!(window.XMLHttpRequestUpload&&window.FileReader);n.support.xhrFormDataFileUpload=!!window.FormData;n.widget("blueimp.fileupload",{options:{namespace:undefined,dropZone:n(document),pasteZone:n(document),fileInput:undefined,replaceFileInput:!0,paramName:undefined,singleFileUploads:!0,limitMultiFileUploads:undefined,sequentialUploads:!1,limitConcurrentUploads:undefined,forceIframeTransport:!1,redirect:undefined,redirectParamName:undefined,postMessage:undefined,multipart:!0,maxChunkSize:undefined,uploadedBytes:undefined,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,formData:function(n){return n.serializeArray()},add:function(n,t){t.submit()},processData:!1,contentType:!1,cache:!1},_refreshOptionsList:["namespace","fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_BitrateTimer:function(){this.timestamp=+new Date;this.loaded=0;this.bitrate=0;this.getBitrate=function(n,t,i){var r=n-this.timestamp;return(!this.bitrate||!i||r>i)&&(this.bitrate=(t-this.loaded)*(1e3/r)*8,this.loaded=t,this.timestamp=n),this.bitrate}},_isXHRUpload:function(t){return!t.forceIframeTransport&&(!t.multipart&&n.support.xhrFileUpload||n.support.xhrFormDataFileUpload)},_getFormData:function(t){var i;return typeof t.formData=="function"?t.formData(t.form):n.isArray(t.formData)?t.formData:t.formData?(i=[],n.each(t.formData,function(n,t){i.push({name:n,value:t})}),i):[]},_getTotal:function(t){var i=0;return n.each(t,function(n,t){i+=t.size||1}),i},_onProgress:function(n,t){if(n.lengthComputable){var i=+new Date,u,r;if(t._time&&t.progressInterval&&i-t._time<t.progressInterval&&n.loaded!==n.total)return;t._time=i;u=t.total||this._getTotal(t.files);r=parseInt(n.loaded/n.total*(t.chunkSize||u),10)+(t.uploadedBytes||0);this._loaded+=r-(t.loaded||t.uploadedBytes||0);t.lengthComputable=!0;t.loaded=r;t.total=u;t.bitrate=t._bitrateTimer.getBitrate(i,r,t.bitrateInterval);this._trigger("progress",n,t);this._trigger("progressall",n,{lengthComputable:!0,loaded:this._loaded,total:this._total,bitrate:this._bitrateTimer.getBitrate(i,this._loaded,t.bitrateInterval)})}},_initProgressListener:function(t){var r=this,i=t.xhr?t.xhr():n.ajaxSettings.xhr();i.upload&&(n(i.upload).bind("progress",function(n){var i=n.originalEvent;n.lengthComputable=i.lengthComputable;n.loaded=i.loaded;n.total=i.total;r._onProgress(n,t)}),t.xhr=function(){return i})},_initXHRData:function(t){var i,r=t.files[0],f=t.multipart||!n.support.xhrFileUpload,u=t.paramName[0];(!f||t.blob)&&(t.headers=n.extend(t.headers,{"X-File-Name":r.name,"X-File-Type":r.type,"X-File-Size":r.size}),t.blob?f||(t.contentType="application/octet-stream",t.data=t.blob):(t.contentType=r.type,t.data=r));f&&n.support.xhrFormDataFileUpload&&(t.postMessage?(i=this._getFormData(t),t.blob?i.push({name:u,value:t.blob}):n.each(t.files,function(n,r){i.push({name:t.paramName[n]||u,value:r})})):(t.formData instanceof FormData?i=t.formData:(i=new FormData,n.each(this._getFormData(t),function(n,t){i.append(t.name,t.value)})),t.blob?i.append(u,t.blob,r.name):n.each(t.files,function(n,r){r instanceof Blob&&i.append(t.paramName[n]||u,r,r.name)})),t.data=i);t.blob=null},_initIframeSettings:function(t){t.dataType="iframe "+(t.dataType||"");t.formData=this._getFormData(t);t.redirect&&n("<a><\/a>").prop("href",t.url).prop("host")!==location.host&&t.formData.push({name:t.redirectParamName||"redirect",value:t.redirect})},_initDataSettings:function(n){this._isXHRUpload(n)?(this._chunkedUpload(n,!0)||(n.data||this._initXHRData(n),this._initProgressListener(n)),n.postMessage&&(n.dataType="postmessage "+(n.dataType||""))):this._initIframeSettings(n,"iframe")},_getParamName:function(t){var r=n(t.fileInput),i=t.paramName;return i?n.isArray(i)||(i=[i]):(i=[],r.each(function(){for(var t=n(this),u=t.prop("name")||"files[]",r=(t.prop("files")||[1]).length;r;)i.push(u),r-=1}),i.length||(i=[r.prop("name")||"files[]"])),i},_initFormSettings:function(t){t.form&&t.form.length||(t.form=n(t.fileInput.prop("form")),t.form.length||(t.form=n(this.options.fileInput.prop("form"))));t.paramName=this._getParamName(t);t.url||(t.url=t.form.prop("action")||location.href);t.type=(t.type||t.form.prop("method")||"").toUpperCase();t.type!=="POST"&&t.type!=="PUT"&&(t.type="POST");t.formAcceptCharset||(t.formAcceptCharset=t.form.attr("accept-charset"))},_getAJAXSettings:function(t){var i=n.extend({},this.options,t);return this._initFormSettings(i),this._initDataSettings(i),i},_enhancePromise:function(n){return n.success=n.done,n.error=n.fail,n.complete=n.always,n},_getXHRPromise:function(t,i,r){var u=n.Deferred(),f=u.promise();return i=i||this.options.context||f,t===!0?u.resolveWith(i,r):t===!1&&u.rejectWith(i,r),f.abort=u.promise,this._enhancePromise(f)},_chunkedUpload:function(t,i){var u=this,r=t.files[0],e=r.size,f=t.uploadedBytes=t.uploadedBytes||0,o=t.maxChunkSize||e,a=r.webkitSlice||r.mozSlice||r.slice,s,h,c,l;return!(this._isXHRUpload(t)&&a&&(f||o<e))||t.data?!1:i?!0:f>=e?(r.error="uploadedBytes",this._getXHRPromise(!1,t.context,[null,"error",r.error])):(h=Math.ceil((e-f)/o),s=function(i){return i?s(i-=1).pipe(function(){var e=n.extend({},t);return e.blob=a.call(r,f+i*o,f+(i+1)*o),e.chunkIndex=i,e.chunksNumber=h,e.chunkSize=e.blob.size,u._initXHRData(e),u._initProgressListener(e),c=(n.ajax(e)||u._getXHRPromise(!1,e.context)).done(function(){e.loaded||u._onProgress(n.Event("progress",{lengthComputable:!0,loaded:e.chunkSize,total:e.chunkSize}),e);t.uploadedBytes=e.uploadedBytes+=e.chunkSize})}):u._getXHRPromise(!0,t.context)},l=s(h),l.abort=function(){return c.abort()},this._enhancePromise(l))},_beforeSend:function(n,t){this._active===0&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer);this._active+=1;this._loaded+=t.uploadedBytes||0;this._total+=this._getTotal(t.files)},_onDone:function(t,i,r,u){this._isXHRUpload(u)||this._onProgress(n.Event("progress",{lengthComputable:!0,loaded:1,total:1}),u);u.result=t;u.textStatus=i;u.jqXHR=r;this._trigger("done",null,u)},_onFail:function(n,t,i,r){r.jqXHR=n;r.textStatus=t;r.errorThrown=i;this._trigger("fail",null,r);r.recalculateProgress&&(this._loaded-=r.loaded||r.uploadedBytes||0,this._total-=r.total||this._getTotal(r.files))},_onAlways:function(n,t,i,r){this._active-=1;r.textStatus=t;i&&i.always?(r.jqXHR=i,r.result=n):(r.jqXHR=n,r.errorThrown=i);this._trigger("always",null,r);this._active===0&&(this._trigger("stop"),this._loaded=this._total=0,this._bitrateTimer=null)},_onSend:function(t,i){var r=this,f,e,o,u=r._getAJAXSettings(i),s=function(i,e){return r._sending+=1,u._bitrateTimer=new r._BitrateTimer,f=f||(i!==!1&&r._trigger("send",t,u)!==!1&&(r._chunkedUpload(u)||n.ajax(u))||r._getXHRPromise(!1,u.context,e)).done(function(n,t,i){r._onDone(n,t,i,u)}).fail(function(n,t,i){r._onFail(n,t,i,u)}).always(function(n,t,i){if(r._sending-=1,r._onAlways(n,t,i,u),u.limitConcurrentUploads&&u.limitConcurrentUploads>r._sending)for(var f=r._slots.shift(),e;f;){if(e=f.state?f.state()==="pending":!f.isRejected(),e){f.resolve();break}f=r._slots.shift()}})};return(this._beforeSend(t,u),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending)?(this.options.limitConcurrentUploads>1?(e=n.Deferred(),this._slots.push(e),o=e.pipe(s)):o=this._sequence=this._sequence.pipe(s,s),o.abort=function(){var n=[undefined,"abort","abort"];return f?f.abort():(e&&e.rejectWith(o,n),s(!1,n))},this._enhancePromise(o)):s()},_onAdd:function(t,i){var c=this,l=!0,u=n.extend({},this.options,i),f=u.limitMultiFileUploads,s=this._getParamName(u),e,h,o,r;if((u.singleFileUploads||f)&&this._isXHRUpload(u))if(!u.singleFileUploads&&f)for(o=[],e=[],r=0;r<i.files.length;r+=f)o.push(i.files.slice(r,r+f)),h=s.slice(r,r+f),h.length||(h=s),e.push(h);else e=s;else o=[i.files],e=[s];return i.originalFiles=i.files,n.each(o||i.files,function(r,u){var f=n.extend({},i);return f.files=o?u:[u],f.paramName=e[r],f.submit=function(){return f.jqXHR=this.jqXHR=c._trigger("submit",t,this)!==!1&&c._onSend(t,this),this.jqXHR},l=c._trigger("add",t,f)}),l},_replaceFileInput:function(t){var i=t.clone(!0);n("<form><\/form>").append(i)[0].reset();t.after(i).detach();n.cleanData(t.unbind("remove"));this.options.fileInput=this.options.fileInput.map(function(n,r){return r===t[0]?i[0]:r});t[0]===this.element[0]&&(this.element=i)},_handleFileTreeEntry:function(t,i){var e=this,r=n.Deferred(),u=function(n){n&&!n.entry&&(n.entry=t);r.resolve([n])},f;return i=i||"",t.isFile?t.file(function(n){n.relativePath=i;r.resolve(n)},u):t.isDirectory?(f=t.createReader(),f.readEntries(function(n){e._handleFileTreeEntries(n,i+t.name+"/").done(function(n){r.resolve(n)}).fail(u)},u)):r.resolve([]),r.promise()},_handleFileTreeEntries:function(t,i){var r=this;return n.when.apply(n,n.map(t,function(n){return r._handleFileTreeEntry(n,i)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(t){t=t||{};var i=t.items;return i&&i.length&&(i[0].webkitGetAsEntry||i[0].getAsEntry)?this._handleFileTreeEntries(n.map(i,function(n){return n.webkitGetAsEntry?n.webkitGetAsEntry():n.getAsEntry()})):n.Deferred().resolve(n.makeArray(t.files)).promise()},_getSingleFileInputFiles:function(t){t=n(t);var r=t.prop("webkitEntries")||t.prop("entries"),i,u;if(r&&r.length)return this._handleFileTreeEntries(r);if(i=n.makeArray(t.prop("files")),!i.length){if(u=t.prop("value"),!u)return n.Deferred().resolve([]).promise();i=[{name:u.replace(/^.*\\/,"")}]}return n.Deferred().resolve(i).promise()},_getFileInputFiles:function(t){return!(t instanceof n)||t.length===1?this._getSingleFileInputFiles(t):n.when.apply(n,n.map(t,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_onChange:function(t){var i=t.data.fileupload,r={fileInput:n(t.target),form:n(t.target.form)};i._getFileInputFiles(r.fileInput).always(function(n){r.files=n;i.options.replaceFileInput&&i._replaceFileInput(r.fileInput);i._trigger("change",t,r)!==!1&&i._onAdd(t,r)})},_onPaste:function(t){var r=t.data.fileupload,u=t.originalEvent.clipboardData,f=u&&u.items||[],i={files:[]};return n.each(f,function(n,t){var r=t.getAsFile&&t.getAsFile();r&&i.files.push(r)}),r._trigger("paste",t,i)===!1||r._onAdd(t,i)===!1?!1:void 0},_onDrop:function(n){n.preventDefault();var t=n.data.fileupload,r=n.dataTransfer=n.originalEvent.dataTransfer,i={};t._getDroppedFiles(r).always(function(r){i.files=r;t._trigger("drop",n,i)!==!1&&t._onAdd(n,i)})},_onDragOver:function(n){var i=n.data.fileupload,t=n.dataTransfer=n.originalEvent.dataTransfer;if(i._trigger("dragover",n)===!1)return!1;t&&(t.dropEffect="copy");n.preventDefault()},_initEventHandlers:function(){var n=this.options.namespace;this._isXHRUpload(this.options)&&(this.options.dropZone.bind("dragover."+n,{fileupload:this},this._onDragOver).bind("drop."+n,{fileupload:this},this._onDrop),this.options.pasteZone.bind("paste."+n,{fileupload:this},this._onPaste));this.options.fileInput.bind("change."+n,{fileupload:this},this._onChange)},_destroyEventHandlers:function(){var n=this.options.namespace;this.options.dropZone.unbind("dragover."+n,this._onDragOver).unbind("drop."+n,this._onDrop);this.options.pasteZone.unbind("paste."+n,this._onPaste);this.options.fileInput.unbind("change."+n,this._onChange)},_setOption:function(t,i){var r=n.inArray(t,this._refreshOptionsList)!==-1;r&&this._destroyEventHandlers();n.Widget.prototype._setOption.call(this,t,i);r&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var t=this.options;t.fileInput===undefined?t.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):t.fileInput instanceof n||(t.fileInput=n(t.fileInput));t.dropZone instanceof n||(t.dropZone=n(t.dropZone));t.pasteZone instanceof n||(t.pasteZone=n(t.pasteZone))},_create:function(){var t=this.options;n.extend(t,n(this.element[0].cloneNode(!1)).data());t.namespace=t.namespace||this.widgetName;this._initSpecialOptions();this._slots=[];this._sequence=this._getXHRPromise(!0);this._sending=this._active=this._loaded=this._total=0;this._initEventHandlers()},destroy:function(){this._destroyEventHandlers();n.Widget.prototype.destroy.call(this)},enable:function(){var t=!1;this.options.disabled&&(t=!0);n.Widget.prototype.enable.call(this);t&&this._initEventHandlers()},disable:function(){this.options.disabled||this._destroyEventHandlers();n.Widget.prototype.disable.call(this)},add:function(t){var i=this;t&&!this.options.disabled&&(t.fileInput&&!t.files?this._getFileInputFiles(t.fileInput).always(function(n){t.files=n;i._onAdd(null,t)}):(t.files=n.makeArray(t.files),this._onAdd(null,t)))},send:function(t){if(t&&!this.options.disabled){if(t.fileInput&&!t.files){var e=this,i=n.Deferred(),r=i.promise(),u,f;return r.abort=function(){return(f=!0,u)?u.abort():(i.reject(null,"abort","abort"),r)},this._getFileInputFiles(t.fileInput).always(function(n){f||(t.files=n,u=e._onSend(null,t).then(function(n,t,r){i.resolve(n,t,r)},function(n,t,r){i.reject(n,t,r)}))}),this._enhancePromise(r)}if(t.files=n.makeArray(t.files),t.files.length)return this._onSend(null,t)}return this._getXHRPromise(!1,t&&t.context)}})});
(function(n){var t=(n.blueimpFP||n.blueimp).fileupload;n.widget("blueimpUI.fileupload",t,{options:{dataType:"json",namespace:"fileupload-single-ui",minFileSize:undefined,maxFileSize:undefined,acceptFileTypes:/.+$/i},_getProgressInfo:function(n){return _.formatBitrate(n.bitrate)+" | "+_.formatPercentage(n.loaded/n.total)+" | "+_.formatFileSize(n.loaded)+" / "+_.formatFileSize(n.total)},_transition:function(t){var i=n.Deferred();return t.on(Prefixer.event.transitionEnd,function(n){n.target===t[0]&&(t.off(Prefixer.event.transitionEnd),i.resolveWith(t))}).addClass("success").removeClass("show"),i},_validate:function(n){return n.error?n.error:(this.options.acceptFileTypes.test(n.type)||this.options.acceptFileTypes.test(n.name))?this.options.maxFileSize&&n.size>this.options.maxFileSize?"maxFileSize":typeof n.size=="number"&&n.size<this.options.minFileSize?"minFileSize":null:"acceptFileTypes"},_initSpecialOptions:function(){t.prototype._initSpecialOptions.call(this);this.options.dropZone=this.element},_initEventHandlers:function(){function e(n){var t=r.find(".fileinput-button"),i=r.find(".cancel");n?(t.hide(),i.show()):(t.show(),i.hide())}t.prototype._initEventHandlers.call(this);var i=this.options.namespace,u="fileupload",o={fileupload:this},f=this,r=this.element;this.element.on(u+"dragover."+i,function(n){n.preventDefault()}).on(u+"drop."+i,function(n,t){t.files&&(t.files=t.files.slice(0,1));t.originalFiles&&(t.originalFiles=t.originalFiles.slice(0,1))}).on(u+"add."+i,function(n,t){r.data("data",t)}).on(u+"send."+i,function(t,i){var u=f._validate(i.files[0]);if(u)return u==="acceptFileTypes"&&alert("Wrong filetype: expected "+f.options.acceptFileTypes.source),!1;e(!0);r.find(".fileupload-progress").addClass("show");i.dataType&&i.dataType.substr(0,6)==="iframe"&&r.find(".progress-bar").addClass(!n.support.transition&&"progress-animated").attr("aria-valuenow",100).css("width","100%")}).on(u+"fail."+i,function(){}).on(u+"always."+i,function(){var n=r.find(".fileupload-progress");n.hasClass("show")&&f._transition(n).done(function(){e(!1);n.removeClass("success").find(".progress-bar").attr("aria-valuenow",0).css("width","0%").find(".progress-extended").html("&nbsp;")})}).on(u+"progressall."+i,function(n,t){var i=r.find(".fileupload-progress"),u=parseInt(t.loaded/t.total*100,10),e=i.find(".progress-extended");e.length?e.html(f._getProgressInfo(t)):console.debug(f._getProgressInfo(t));i.find(".progress-bar").attr("aria-valuenow",u).css("width",u+"%")}).on("click."+i,"button.cancel",o,function(n){n.preventDefault();var t=r.data("data")||{};t.errorThrown="abort";t.jqXHR?t.jqXHR.abort():(t.errorThrown="abort",n.data.fileupload._trigger("fail",n,t))})},_destroyEventHandlers:function(){this.element.off("."+this.options.namespace);t.prototype._destroyEventHandlers.call(this)},_enableFileInputButton:function(){this.element.find(".fileinput-button input").prop("disabled",!1).parent().removeClass("disabled")},_disableFileInputButton:function(){this.element.find(".fileinput-button input").prop("disabled",!0).parent().addClass("disabled")},enable:function(){var n=!1;this.options.disabled&&(n=!0);t.prototype.enable.call(this);n&&(this.element.find("input, button").prop("disabled",!1),this._enableFileInputButton())},disable:function(){this.options.disabled||(this.element.find("input, button").prop("disabled",!0),this._disableFileInputButton());t.prototype.disable.call(this)}});n.fn.fileUploadWrapper=function(t){return this.each(function(){var i=n(this),r=i.find(".remove"),u=i.find(".cancel"),f=i.find(".fileinput-button"),e=_.isString(i.data("accept"))?new RegExp("(.|/)("+i.data("accept")+")$","i"):undefined,o={url:i.data("upload-url"),dataType:"json",acceptFileTypes:e,pasteZone:null,send:function(n,r){t.onUploading&&t.onUploading.apply(this,[n,i,r])},done:function(n,e){var s=e.result,o;s.success&&(i.data("show-remove-after-upload")&&r.show(),o=i.closest(".fileupload-container"),o.find(".fileupload-thumb").css("background-image",'url("'+e.result.imageUrl+'")'),o.find(".hidden").val(e.result.pictureId).trigger("change"),u.hide(),f.show(),t.onUploadCompleted&&t.onUploadCompleted.apply(this,[n,i,e]))},error:function(n,r,u){u==="abort"?t.onAborted&&t.onAborted.apply(this,i):t.onError&&t.onError.apply(this,[i,r,u])},always:function(n,r){t.onCompleted&&t.onCompleted.apply(this,[n,i,r])}};t=n.extend({},o,t);i.fileupload(t);r.on("click",function(r){r.preventDefault();var u=i.closest(".fileupload-container");u.find(".fileupload-thumb").css("background-image",'url("'+i.data("fallback-url")+'")');u.find(".hidden").val(0).trigger("change");n(this).hide();t.onFileRemove&&t.onFileRemove.apply(this,[r,i])});n("#add-product-picture").on("click",function(){r.trigger("click")})})}})(jQuery);/*!
 * jQuery UI Widget 1.11.0
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/jQuery.widget/
 */
(function(n){typeof define=="function"&&define.amd?define(["jquery"],n):n(jQuery)})(function(n){var i=0,t=Array.prototype.slice;return n.cleanData=function(t){return function(i){for(var r=0,u;(u=i[r])!=null;r++)try{n(u).triggerHandler("remove")}catch(f){}t(i)}}(n.cleanData),n.widget=function(t,i,r){var s,f,u,o,h={},e=t.split(".")[0];return t=t.split(".")[1],s=e+"-"+t,r||(r=i,i=n.Widget),n.expr[":"][s.toLowerCase()]=function(t){return!!n.data(t,s)},n[e]=n[e]||{},f=n[e][t],u=n[e][t]=function(n,t){if(!this._createWidget)return new u(n,t);arguments.length&&this._createWidget(n,t)},n.extend(u,f,{version:r.version,_proto:n.extend({},r),_childConstructors:[]}),o=new i,o.options=n.widget.extend({},o.options),n.each(r,function(t,r){if(!n.isFunction(r)){h[t]=r;return}h[t]=function(){var n=function(){return i.prototype[t].apply(this,arguments)},u=function(n){return i.prototype[t].apply(this,n)};return function(){var i=this._super,f=this._superApply,t;return this._super=n,this._superApply=u,t=r.apply(this,arguments),this._super=i,this._superApply=f,t}}()}),u.prototype=n.widget.extend(o,{widgetEventPrefix:f?o.widgetEventPrefix||t:t},h,{constructor:u,namespace:e,widgetName:t,widgetFullName:s}),f?(n.each(f._childConstructors,function(t,i){var r=i.prototype;n.widget(r.namespace+"."+r.widgetName,u,i._proto)}),delete f._childConstructors):i._childConstructors.push(u),n.widget.bridge(t,u),u},n.widget.extend=function(i){for(var e=t.call(arguments,1),f=0,o=e.length,r,u;f<o;f++)for(r in e[f])u=e[f][r],e[f].hasOwnProperty(r)&&u!==undefined&&(i[r]=n.isPlainObject(u)?n.isPlainObject(i[r])?n.widget.extend({},i[r],u):n.widget.extend({},u):u);return i},n.widget.bridge=function(i,r){var u=r.prototype.widgetFullName||i;n.fn[i]=function(f){var s=typeof f=="string",o=t.call(arguments,1),e=this;return f=!s&&o.length?n.widget.extend.apply(null,[f].concat(o)):f,s?this.each(function(){var t,r=n.data(this,u);return f==="instance"?(e=r,!1):r?!n.isFunction(r[f])||f.charAt(0)==="_"?n.error("no such method '"+f+"' for "+i+" widget instance"):(t=r[f].apply(r,o),t!==r&&t!==undefined?(e=t&&t.jquery?e.pushStack(t.get()):t,!1):void 0):n.error("cannot call methods on "+i+" prior to initialization; attempted to call method '"+f+"'")}):this.each(function(){var t=n.data(this,u);t?(t.option(f||{}),t._init&&t._init()):n.data(this,u,new r(f,this))}),e}},n.Widget=function(){},n.Widget._childConstructors=[],n.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,r){r=n(r||this.defaultElement||this)[0];this.element=n(r);this.uuid=i++;this.eventNamespace="."+this.widgetName+this.uuid;this.options=n.widget.extend({},this.options,this._getCreateOptions(),t);this.bindings=n();this.hoverable=n();this.focusable=n();r!==this&&(n.data(r,this.widgetFullName,this),this._on(!0,this.element,{remove:function(n){n.target===r&&this.destroy()}}),this.document=n(r.style?r.ownerDocument:r.document||r),this.window=n(this.document[0].defaultView||this.document[0].parentWindow));this._create();this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:n.noop,_getCreateEventData:n.noop,_create:n.noop,_init:n.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(n.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:n.noop,widget:function(){return this.element},option:function(t,i){var e=t,r,u,f;if(arguments.length===0)return n.widget.extend({},this.options);if(typeof t=="string")if(e={},r=t.split("."),t=r.shift(),r.length){for(u=e[t]=n.widget.extend({},this.options[t]),f=0;f<r.length-1;f++)u[r[f]]=u[r[f]]||{},u=u[r[f]];if(t=r.pop(),arguments.length===1)return u[t]===undefined?null:u[t];u[t]=i}else{if(arguments.length===1)return this.options[t]===undefined?null:this.options[t];e[t]=i}return this._setOptions(e),this},_setOptions:function(n){for(var t in n)this._setOption(t,n[t]);return this},_setOption:function(n,t){return this.options[n]=t,n==="disabled"&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(t,i,r){var f,u=this;typeof t!="boolean"&&(r=i,i=t,t=!1);r?(i=f=n(i),this.bindings=this.bindings.add(i)):(r=i,i=this.element,f=this.widget());n.each(r,function(r,e){function o(){if(t||u.options.disabled!==!0&&!n(this).hasClass("ui-state-disabled"))return(typeof e=="string"?u[e]:e).apply(u,arguments)}typeof e!="string"&&(o.guid=e.guid=e.guid||o.guid||n.guid++);var s=r.match(/^([\w:-]*)\s*(.*)$/),h=s[1]+u.eventNamespace,c=s[2];c?f.delegate(c,h,o):i.bind(h,o)})},_off:function(n,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;n.unbind(t).undelegate(t)},_delay:function(n,t){function r(){return(typeof n=="string"?i[n]:n).apply(i,arguments)}var i=this;return setTimeout(r,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t);this._on(t,{mouseenter:function(t){n(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){n(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t);this._on(t,{focusin:function(t){n(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){n(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,i,r){var u,f,e=this.options[t];if(r=r||{},i=n.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],f=i.originalEvent,f)for(u in f)u in i||(i[u]=f[u]);return this.element.trigger(i,r),!(n.isFunction(e)&&e.apply(this.element[0],[i].concat(r))===!1||i.isDefaultPrevented())}},n.each({show:"fadeIn",hide:"fadeOut"},function(t,i){n.Widget.prototype["_"+t]=function(r,u,f){typeof u=="string"&&(u={effect:u});var o,e=u?u===!0||typeof u=="number"?i:u.effect||i:t;u=u||{};typeof u=="number"&&(u={duration:u});o=!n.isEmptyObject(u);u.complete=f;u.delay&&r.delay(u.delay);o&&n.effects&&n.effects.effect[e]?r[t](u):e!==t&&r[e]?r[e](u.duration,u.easing,f):r.queue(function(i){n(this)[t]();f&&f.call(r[0]);i()})}}),n.widget});
(function(n){"use strict";typeof define=="function"&&define.amd?define(["jquery"],n):n(window.jQuery)})(function(n){"use strict";var t=0;n.ajaxTransport("iframe",function(i){if(i.async&&(i.type==="POST"||i.type==="GET")){var r,u;return{send:function(f,e){r=n('<form style="display:none;"><\/form>');r.attr("accept-charset",i.formAcceptCharset);u=n('<iframe src="javascript:false;" name="iframe-transport-'+(t+=1)+'"><\/iframe>').bind("load",function(){var t,f=n.isArray(i.paramName)?i.paramName:[i.paramName];u.unbind("load").bind("load",function(){var t;try{if(t=u.contents(),!t.length||!t[0].firstChild)throw new Error;}catch(i){t=undefined}e(200,"success",{iframe:t});n('<iframe src="javascript:false;"><\/iframe>').appendTo(r);r.remove()});r.prop("target",u.prop("name")).prop("action",i.url).prop("method",i.type);i.formData&&n.each(i.formData,function(t,i){n('<input type="hidden"/>').prop("name",i.name).val(i.value).appendTo(r)});i.fileInput&&i.fileInput.length&&i.type==="POST"&&(t=i.fileInput.clone(),i.fileInput.after(function(n){return t[n]}),i.paramName&&i.fileInput.each(function(t){n(this).prop("name",f[t]||i.paramName)}),r.append(i.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data"));r.submit();t&&t.length&&i.fileInput.each(function(i,r){var u=n(t[i]);n(r).prop("name",u.prop("name"));u.replaceWith(r)})});r.append(u).appendTo(document.body)},abort:function(){u&&u.unbind("load").prop("src","javascript".concat(":false;"));r&&r.remove()}}}});n.ajaxSetup({converters:{"iframe text":function(t){return n(t[0].body).text()},"iframe json":function(t){return n.parseJSON(n(t[0].body).text())},"iframe html":function(t){return n(t[0].body).html()},"iframe script":function(t){return n.globalEval(n(t[0].body).text())}}})});
(function(n){"use strict";typeof define=="function"&&define.amd?define(["jquery","jquery.ui.widget"],n):n(window.jQuery)})(function(n){"use strict";n.support.xhrFileUpload=!!(window.XMLHttpRequestUpload&&window.FileReader);n.support.xhrFormDataFileUpload=!!window.FormData;n.widget("blueimp.fileupload",{options:{namespace:undefined,dropZone:n(document),pasteZone:n(document),fileInput:undefined,replaceFileInput:!0,paramName:undefined,singleFileUploads:!0,limitMultiFileUploads:undefined,sequentialUploads:!1,limitConcurrentUploads:undefined,forceIframeTransport:!1,redirect:undefined,redirectParamName:undefined,postMessage:undefined,multipart:!0,maxChunkSize:undefined,uploadedBytes:undefined,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,formData:function(n){return n.serializeArray()},add:function(n,t){t.submit()},processData:!1,contentType:!1,cache:!1},_refreshOptionsList:["namespace","fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_BitrateTimer:function(){this.timestamp=+new Date;this.loaded=0;this.bitrate=0;this.getBitrate=function(n,t,i){var r=n-this.timestamp;return(!this.bitrate||!i||r>i)&&(this.bitrate=(t-this.loaded)*(1e3/r)*8,this.loaded=t,this.timestamp=n),this.bitrate}},_isXHRUpload:function(t){return!t.forceIframeTransport&&(!t.multipart&&n.support.xhrFileUpload||n.support.xhrFormDataFileUpload)},_getFormData:function(t){var i;return typeof t.formData=="function"?t.formData(t.form):n.isArray(t.formData)?t.formData:t.formData?(i=[],n.each(t.formData,function(n,t){i.push({name:n,value:t})}),i):[]},_getTotal:function(t){var i=0;return n.each(t,function(n,t){i+=t.size||1}),i},_onProgress:function(n,t){if(n.lengthComputable){var i=+new Date,u,r;if(t._time&&t.progressInterval&&i-t._time<t.progressInterval&&n.loaded!==n.total)return;t._time=i;u=t.total||this._getTotal(t.files);r=parseInt(n.loaded/n.total*(t.chunkSize||u),10)+(t.uploadedBytes||0);this._loaded+=r-(t.loaded||t.uploadedBytes||0);t.lengthComputable=!0;t.loaded=r;t.total=u;t.bitrate=t._bitrateTimer.getBitrate(i,r,t.bitrateInterval);this._trigger("progress",n,t);this._trigger("progressall",n,{lengthComputable:!0,loaded:this._loaded,total:this._total,bitrate:this._bitrateTimer.getBitrate(i,this._loaded,t.bitrateInterval)})}},_initProgressListener:function(t){var r=this,i=t.xhr?t.xhr():n.ajaxSettings.xhr();i.upload&&(n(i.upload).bind("progress",function(n){var i=n.originalEvent;n.lengthComputable=i.lengthComputable;n.loaded=i.loaded;n.total=i.total;r._onProgress(n,t)}),t.xhr=function(){return i})},_initXHRData:function(t){var i,r=t.files[0],f=t.multipart||!n.support.xhrFileUpload,u=t.paramName[0];(!f||t.blob)&&(t.headers=n.extend(t.headers,{"X-File-Name":r.name,"X-File-Type":r.type,"X-File-Size":r.size}),t.blob?f||(t.contentType="application/octet-stream",t.data=t.blob):(t.contentType=r.type,t.data=r));f&&n.support.xhrFormDataFileUpload&&(t.postMessage?(i=this._getFormData(t),t.blob?i.push({name:u,value:t.blob}):n.each(t.files,function(n,r){i.push({name:t.paramName[n]||u,value:r})})):(t.formData instanceof FormData?i=t.formData:(i=new FormData,n.each(this._getFormData(t),function(n,t){i.append(t.name,t.value)})),t.blob?i.append(u,t.blob,r.name):n.each(t.files,function(n,r){r instanceof Blob&&i.append(t.paramName[n]||u,r,r.name)})),t.data=i);t.blob=null},_initIframeSettings:function(t){t.dataType="iframe "+(t.dataType||"");t.formData=this._getFormData(t);t.redirect&&n("<a><\/a>").prop("href",t.url).prop("host")!==location.host&&t.formData.push({name:t.redirectParamName||"redirect",value:t.redirect})},_initDataSettings:function(n){this._isXHRUpload(n)?(this._chunkedUpload(n,!0)||(n.data||this._initXHRData(n),this._initProgressListener(n)),n.postMessage&&(n.dataType="postmessage "+(n.dataType||""))):this._initIframeSettings(n,"iframe")},_getParamName:function(t){var r=n(t.fileInput),i=t.paramName;return i?n.isArray(i)||(i=[i]):(i=[],r.each(function(){for(var t=n(this),u=t.prop("name")||"files[]",r=(t.prop("files")||[1]).length;r;)i.push(u),r-=1}),i.length||(i=[r.prop("name")||"files[]"])),i},_initFormSettings:function(t){t.form&&t.form.length||(t.form=n(t.fileInput.prop("form")),t.form.length||(t.form=n(this.options.fileInput.prop("form"))));t.paramName=this._getParamName(t);t.url||(t.url=t.form.prop("action")||location.href);t.type=(t.type||t.form.prop("method")||"").toUpperCase();t.type!=="POST"&&t.type!=="PUT"&&(t.type="POST");t.formAcceptCharset||(t.formAcceptCharset=t.form.attr("accept-charset"))},_getAJAXSettings:function(t){var i=n.extend({},this.options,t);return this._initFormSettings(i),this._initDataSettings(i),i},_enhancePromise:function(n){return n.success=n.done,n.error=n.fail,n.complete=n.always,n},_getXHRPromise:function(t,i,r){var u=n.Deferred(),f=u.promise();return i=i||this.options.context||f,t===!0?u.resolveWith(i,r):t===!1&&u.rejectWith(i,r),f.abort=u.promise,this._enhancePromise(f)},_chunkedUpload:function(t,i){var u=this,r=t.files[0],e=r.size,f=t.uploadedBytes=t.uploadedBytes||0,o=t.maxChunkSize||e,a=r.webkitSlice||r.mozSlice||r.slice,s,h,c,l;return!(this._isXHRUpload(t)&&a&&(f||o<e))||t.data?!1:i?!0:f>=e?(r.error="uploadedBytes",this._getXHRPromise(!1,t.context,[null,"error",r.error])):(h=Math.ceil((e-f)/o),s=function(i){return i?s(i-=1).pipe(function(){var e=n.extend({},t);return e.blob=a.call(r,f+i*o,f+(i+1)*o),e.chunkIndex=i,e.chunksNumber=h,e.chunkSize=e.blob.size,u._initXHRData(e),u._initProgressListener(e),c=(n.ajax(e)||u._getXHRPromise(!1,e.context)).done(function(){e.loaded||u._onProgress(n.Event("progress",{lengthComputable:!0,loaded:e.chunkSize,total:e.chunkSize}),e);t.uploadedBytes=e.uploadedBytes+=e.chunkSize})}):u._getXHRPromise(!0,t.context)},l=s(h),l.abort=function(){return c.abort()},this._enhancePromise(l))},_beforeSend:function(n,t){this._active===0&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer);this._active+=1;this._loaded+=t.uploadedBytes||0;this._total+=this._getTotal(t.files)},_onDone:function(t,i,r,u){this._isXHRUpload(u)||this._onProgress(n.Event("progress",{lengthComputable:!0,loaded:1,total:1}),u);u.result=t;u.textStatus=i;u.jqXHR=r;this._trigger("done",null,u)},_onFail:function(n,t,i,r){r.jqXHR=n;r.textStatus=t;r.errorThrown=i;this._trigger("fail",null,r);r.recalculateProgress&&(this._loaded-=r.loaded||r.uploadedBytes||0,this._total-=r.total||this._getTotal(r.files))},_onAlways:function(n,t,i,r){this._active-=1;r.textStatus=t;i&&i.always?(r.jqXHR=i,r.result=n):(r.jqXHR=n,r.errorThrown=i);this._trigger("always",null,r);this._active===0&&(this._trigger("stop"),this._loaded=this._total=0,this._bitrateTimer=null)},_onSend:function(t,i){var r=this,f,e,o,u=r._getAJAXSettings(i),s=function(i,e){return r._sending+=1,u._bitrateTimer=new r._BitrateTimer,f=f||(i!==!1&&r._trigger("send",t,u)!==!1&&(r._chunkedUpload(u)||n.ajax(u))||r._getXHRPromise(!1,u.context,e)).done(function(n,t,i){r._onDone(n,t,i,u)}).fail(function(n,t,i){r._onFail(n,t,i,u)}).always(function(n,t,i){if(r._sending-=1,r._onAlways(n,t,i,u),u.limitConcurrentUploads&&u.limitConcurrentUploads>r._sending)for(var f=r._slots.shift(),e;f;){if(e=f.state?f.state()==="pending":!f.isRejected(),e){f.resolve();break}f=r._slots.shift()}})};return(this._beforeSend(t,u),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending)?(this.options.limitConcurrentUploads>1?(e=n.Deferred(),this._slots.push(e),o=e.pipe(s)):o=this._sequence=this._sequence.pipe(s,s),o.abort=function(){var n=[undefined,"abort","abort"];return f?f.abort():(e&&e.rejectWith(o,n),s(!1,n))},this._enhancePromise(o)):s()},_onAdd:function(t,i){var c=this,l=!0,u=n.extend({},this.options,i),f=u.limitMultiFileUploads,s=this._getParamName(u),e,h,o,r;if((u.singleFileUploads||f)&&this._isXHRUpload(u))if(!u.singleFileUploads&&f)for(o=[],e=[],r=0;r<i.files.length;r+=f)o.push(i.files.slice(r,r+f)),h=s.slice(r,r+f),h.length||(h=s),e.push(h);else e=s;else o=[i.files],e=[s];return i.originalFiles=i.files,n.each(o||i.files,function(r,u){var f=n.extend({},i);return f.files=o?u:[u],f.paramName=e[r],f.submit=function(){return f.jqXHR=this.jqXHR=c._trigger("submit",t,this)!==!1&&c._onSend(t,this),this.jqXHR},l=c._trigger("add",t,f)}),l},_replaceFileInput:function(t){var i=t.clone(!0);n("<form><\/form>").append(i)[0].reset();t.after(i).detach();n.cleanData(t.unbind("remove"));this.options.fileInput=this.options.fileInput.map(function(n,r){return r===t[0]?i[0]:r});t[0]===this.element[0]&&(this.element=i)},_handleFileTreeEntry:function(t,i){var e=this,r=n.Deferred(),u=function(n){n&&!n.entry&&(n.entry=t);r.resolve([n])},f;return i=i||"",t.isFile?t.file(function(n){n.relativePath=i;r.resolve(n)},u):t.isDirectory?(f=t.createReader(),f.readEntries(function(n){e._handleFileTreeEntries(n,i+t.name+"/").done(function(n){r.resolve(n)}).fail(u)},u)):r.resolve([]),r.promise()},_handleFileTreeEntries:function(t,i){var r=this;return n.when.apply(n,n.map(t,function(n){return r._handleFileTreeEntry(n,i)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(t){t=t||{};var i=t.items;return i&&i.length&&(i[0].webkitGetAsEntry||i[0].getAsEntry)?this._handleFileTreeEntries(n.map(i,function(n){return n.webkitGetAsEntry?n.webkitGetAsEntry():n.getAsEntry()})):n.Deferred().resolve(n.makeArray(t.files)).promise()},_getSingleFileInputFiles:function(t){t=n(t);var r=t.prop("webkitEntries")||t.prop("entries"),i,u;if(r&&r.length)return this._handleFileTreeEntries(r);if(i=n.makeArray(t.prop("files")),!i.length){if(u=t.prop("value"),!u)return n.Deferred().resolve([]).promise();i=[{name:u.replace(/^.*\\/,"")}]}return n.Deferred().resolve(i).promise()},_getFileInputFiles:function(t){return!(t instanceof n)||t.length===1?this._getSingleFileInputFiles(t):n.when.apply(n,n.map(t,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_onChange:function(t){var i=t.data.fileupload,r={fileInput:n(t.target),form:n(t.target.form)};i._getFileInputFiles(r.fileInput).always(function(n){r.files=n;i.options.replaceFileInput&&i._replaceFileInput(r.fileInput);i._trigger("change",t,r)!==!1&&i._onAdd(t,r)})},_onPaste:function(t){var r=t.data.fileupload,u=t.originalEvent.clipboardData,f=u&&u.items||[],i={files:[]};return n.each(f,function(n,t){var r=t.getAsFile&&t.getAsFile();r&&i.files.push(r)}),r._trigger("paste",t,i)===!1||r._onAdd(t,i)===!1?!1:void 0},_onDrop:function(n){n.preventDefault();var t=n.data.fileupload,r=n.dataTransfer=n.originalEvent.dataTransfer,i={};t._getDroppedFiles(r).always(function(r){i.files=r;t._trigger("drop",n,i)!==!1&&t._onAdd(n,i)})},_onDragOver:function(n){var i=n.data.fileupload,t=n.dataTransfer=n.originalEvent.dataTransfer;if(i._trigger("dragover",n)===!1)return!1;t&&(t.dropEffect="copy");n.preventDefault()},_initEventHandlers:function(){var n=this.options.namespace;this._isXHRUpload(this.options)&&(this.options.dropZone.bind("dragover."+n,{fileupload:this},this._onDragOver).bind("drop."+n,{fileupload:this},this._onDrop),this.options.pasteZone.bind("paste."+n,{fileupload:this},this._onPaste));this.options.fileInput.bind("change."+n,{fileupload:this},this._onChange)},_destroyEventHandlers:function(){var n=this.options.namespace;this.options.dropZone.unbind("dragover."+n,this._onDragOver).unbind("drop."+n,this._onDrop);this.options.pasteZone.unbind("paste."+n,this._onPaste);this.options.fileInput.unbind("change."+n,this._onChange)},_setOption:function(t,i){var r=n.inArray(t,this._refreshOptionsList)!==-1;r&&this._destroyEventHandlers();n.Widget.prototype._setOption.call(this,t,i);r&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var t=this.options;t.fileInput===undefined?t.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):t.fileInput instanceof n||(t.fileInput=n(t.fileInput));t.dropZone instanceof n||(t.dropZone=n(t.dropZone));t.pasteZone instanceof n||(t.pasteZone=n(t.pasteZone))},_create:function(){var t=this.options;n.extend(t,n(this.element[0].cloneNode(!1)).data());t.namespace=t.namespace||this.widgetName;this._initSpecialOptions();this._slots=[];this._sequence=this._getXHRPromise(!0);this._sending=this._active=this._loaded=this._total=0;this._initEventHandlers()},destroy:function(){this._destroyEventHandlers();n.Widget.prototype.destroy.call(this)},enable:function(){var t=!1;this.options.disabled&&(t=!0);n.Widget.prototype.enable.call(this);t&&this._initEventHandlers()},disable:function(){this.options.disabled||this._destroyEventHandlers();n.Widget.prototype.disable.call(this)},add:function(t){var i=this;t&&!this.options.disabled&&(t.fileInput&&!t.files?this._getFileInputFiles(t.fileInput).always(function(n){t.files=n;i._onAdd(null,t)}):(t.files=n.makeArray(t.files),this._onAdd(null,t)))},send:function(t){if(t&&!this.options.disabled){if(t.fileInput&&!t.files){var e=this,i=n.Deferred(),r=i.promise(),u,f;return r.abort=function(){return(f=!0,u)?u.abort():(i.reject(null,"abort","abort"),r)},this._getFileInputFiles(t.fileInput).always(function(n){f||(t.files=n,u=e._onSend(null,t).then(function(n,t,r){i.resolve(n,t,r)},function(n,t,r){i.reject(n,t,r)}))}),this._enhancePromise(r)}if(t.files=n.makeArray(t.files),t.files.length)return this._onSend(null,t)}return this._getXHRPromise(!1,t&&t.context)}})});
(function(n){var t=(n.blueimpFP||n.blueimp).fileupload;n.widget("blueimpUI.fileupload",t,{options:{dataType:"json",namespace:"fileupload-single-ui",minFileSize:undefined,maxFileSize:undefined,acceptFileTypes:/.+$/i},_getProgressInfo:function(n){return _.formatBitrate(n.bitrate)+" | "+_.formatPercentage(n.loaded/n.total)+" | "+_.formatFileSize(n.loaded)+" / "+_.formatFileSize(n.total)},_transition:function(t){var i=n.Deferred();return t.on(Prefixer.event.transitionEnd,function(n){n.target===t[0]&&(t.off(Prefixer.event.transitionEnd),i.resolveWith(t))}).addClass("success").removeClass("show"),i},_validate:function(n){return n.error?n.error:(this.options.acceptFileTypes.test(n.type)||this.options.acceptFileTypes.test(n.name))?this.options.maxFileSize&&n.size>this.options.maxFileSize?"maxFileSize":typeof n.size=="number"&&n.size<this.options.minFileSize?"minFileSize":null:"acceptFileTypes"},_initSpecialOptions:function(){t.prototype._initSpecialOptions.call(this);this.options.dropZone=this.element},_initEventHandlers:function(){function e(n){var t=r.find(".fileinput-button"),i=r.find(".cancel");n?(t.hide(),i.show()):(t.show(),i.hide())}t.prototype._initEventHandlers.call(this);var i=this.options.namespace,u="fileupload",o={fileupload:this},f=this,r=this.element;this.element.on(u+"dragover."+i,function(n){n.preventDefault()}).on(u+"drop."+i,function(n,t){t.files&&(t.files=t.files.slice(0,1));t.originalFiles&&(t.originalFiles=t.originalFiles.slice(0,1))}).on(u+"add."+i,function(n,t){r.data("data",t)}).on(u+"send."+i,function(t,i){var u=f._validate(i.files[0]);if(u)return u==="acceptFileTypes"&&alert("Wrong filetype: expected "+f.options.acceptFileTypes.source),!1;e(!0);r.find(".fileupload-progress").addClass("show");i.dataType&&i.dataType.substr(0,6)==="iframe"&&r.find(".progress-bar").addClass(!n.support.transition&&"progress-animated").attr("aria-valuenow",100).css("width","100%")}).on(u+"fail."+i,function(){}).on(u+"always."+i,function(){var n=r.find(".fileupload-progress");n.hasClass("show")&&f._transition(n).done(function(){e(!1);n.removeClass("success").find(".progress-bar").attr("aria-valuenow",0).css("width","0%").find(".progress-extended").html("&nbsp;")})}).on(u+"progressall."+i,function(n,t){var i=r.find(".fileupload-progress"),u=parseInt(t.loaded/t.total*100,10),e=i.find(".progress-extended");e.length?e.html(f._getProgressInfo(t)):console.debug(f._getProgressInfo(t));i.find(".progress-bar").attr("aria-valuenow",u).css("width",u+"%")}).on("click."+i,"button.cancel",o,function(n){n.preventDefault();var t=r.data("data")||{};t.errorThrown="abort";t.jqXHR?t.jqXHR.abort():(t.errorThrown="abort",n.data.fileupload._trigger("fail",n,t))})},_destroyEventHandlers:function(){this.element.off("."+this.options.namespace);t.prototype._destroyEventHandlers.call(this)},_enableFileInputButton:function(){this.element.find(".fileinput-button input").prop("disabled",!1).parent().removeClass("disabled")},_disableFileInputButton:function(){this.element.find(".fileinput-button input").prop("disabled",!0).parent().addClass("disabled")},enable:function(){var n=!1;this.options.disabled&&(n=!0);t.prototype.enable.call(this);n&&(this.element.find("input, button").prop("disabled",!1),this._enableFileInputButton())},disable:function(){this.options.disabled||(this.element.find("input, button").prop("disabled",!0),this._disableFileInputButton());t.prototype.disable.call(this)}});n.fn.fileUploadWrapper=function(t){return this.each(function(){var i=n(this),r=i.find(".remove"),u=i.find(".cancel"),f=i.find(".fileinput-button"),e=_.isString(i.data("accept"))?new RegExp("(.|/)("+i.data("accept")+")$","i"):undefined,o={url:i.data("upload-url"),dataType:"json",acceptFileTypes:e,pasteZone:null,send:function(n,r){t.onUploading&&t.onUploading.apply(this,[n,i,r])},done:function(n,e){var s=e.result,o;s.success&&(i.data("show-remove-after-upload")&&r.show(),o=i.closest(".fileupload-container"),o.find(".fileupload-thumb").css("background-image",'url("'+e.result.imageUrl+'")'),o.find(".hidden").val(e.result.pictureId).trigger("change"),u.hide(),f.show(),t.onUploadCompleted&&t.onUploadCompleted.apply(this,[n,i,e]))},error:function(n,r,u){u==="abort"?t.onAborted&&t.onAborted.apply(this,i):t.onError&&t.onError.apply(this,[i,r,u])},always:function(n,r){t.onCompleted&&t.onCompleted.apply(this,[n,i,r])}};t=n.extend({},o,t);i.fileupload(t);r.on("click",function(r){r.preventDefault();var u=i.closest(".fileupload-container");u.find(".fileupload-thumb").css("background-image",'url("'+i.data("fallback-url")+'")');u.find(".hidden").val(0).trigger("change");n(this).hide();t.onFileRemove&&t.onFileRemove.apply(this,[r,i])});n("#add-product-picture").on("click",function(){r.trigger("click")})})}})(jQuery);